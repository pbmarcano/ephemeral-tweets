<% content_for :title, current_user.username %>

<%= turbo_frame_tag "settings" do %>
  <%= form_with(
    model: current_user.setting, 
    class: "my-16", 
    data: { 
      turbo_frame: "timeline",
      controller: "autosubmit",
      autosubmit_target: "form"
    }) do |form| %>

    <div class="flex justify-center space-x-3 text-center text-3xl leading-8 font-extrabold tracking-tight text-gray-900 sm:text-4xl">
      <%= form.label :time_threshold, "Sweep tweets after" %>
      <%= form.select :time_threshold, 
        [7, 30, 90, 180, 365],
        {},
        { 
          class: "rounded shadow border-gray-300",
          data: { action: "autosubmit#submit" }
        } %>
      <div>days</div>
    </div>

    <div class="flex justify-center items-center my-4 text-xl text-gray-500">
      <%= form.check_box :sweeping, 
        class: "h-4 w-4 rounded text-green-500 mr-2",
        data: { action: "autosubmit#submit" } %> 
      <%= form.label :sweeping, "Sweep tweets" %>
    </div>

    <div class="text-center" data-autosubmit-target="submit">
      <%= form.submit "Update Settings", class: "px-8 py-4 rounded-full bg-white border border-gray-200 shadow-md" %>
    </div>
  <% end %>
<% end %>

<%= turbo_frame_tag "timeline" do %>
  <h3><%= timeline_title_for(current_user) %></h3>
  <%= render @tweets %>
<% end %>

<% if Rails.env.development? %>
  <%= link_to "Fetch new tweets", fetch_tweets_path %>
<% end %>

<%= link_to "Sign out", session_path, method: :delete, class: "text-red-500" %>
